{"ast":null,"code":"import _toConsumableArray from\"E:/College-ERP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"E:/College-ERP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/College-ERP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/College-ERP/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'./Attendance.css';import{Paper,TableContainer,TableBody,Table,TableHead,TableCell,TableRow}from\"@material-ui/core\";import{useDispatch,useSelector}from'react-redux';import AuthService from'../../../../ApiServices/AuthService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var MarkAttendance=function MarkAttendance(){var years=[{id:\"1\",yr:\"First\"},{id:\"2\",yr:\"Second\"},{id:\"3\",yr:\"Third\"},{id:\"4\",yr:\"Fourth\"}];var _useSelector=useSelector(function(state){return state.toggle;}),val=_useSelector.val;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),flag=_useState2[0],setFlag=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),flag1=_useState4[0],setFlag1=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),batch=_useState6[0],setBatch=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),year=_useState8[0],setYear=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),batches=_useState10[0],setBatches=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),tableData=_useState12[0],setTableData=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),subject=_useState14[0],setSubject=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),arr=_useState16[0],setArr=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),arrayP=_useState18[0],setArrayP=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),arrayA=_useState20[0],setArrayA=_useState20[1];var idf=localStorage.getItem(\"userid\");useEffect(function(){loadBatch();},[year]);useEffect(function(){AuthService.getEachFaculty(idf).then(function(res){console.log(res);setSubject(res.data.subject);}).catch(function(e){console.log(e);});},[]);var loadBatch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return AuthService.getBatch(year);case 3:res=_context.sent;setBatches(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function loadBatch(){return _ref.apply(this,arguments);};}();var a;var handleClick=function handleClick(id){a=_toConsumableArray(arr);a[id].att=!a[id].att;setArr(a);};useEffect(function(){if(arr.length>0){console.log(arr);}},[arr]);var handleYearDropdown=function handleYearDropdown(e){setYear(e.target.value);console.log(e.target.value);setFlag(false);};var handleBatchDropdown=function handleBatchDropdown(e){e.preventDefault();setBatch(e.target.value);setFlag1(true);};var handleApply=function handleApply(e){e.preventDefault();if(year&&batch){AuthService.getStudents(batch,year).then(function(res){console.log(res);setTableData(res.data.students);setArr(res.data.students.map(function(data){return{id:data._id,att:true};}));}).catch(function(e){console.log(e);});}else{// show error\n}};var today=new Date();var dd=String(today.getDate()).padStart(2,'0');var mm=String(today.getMonth()+1).padStart(2,'0');var yyyy=today.getFullYear();var handleAtt=function handleAtt(){var p=[];var a=[];for(var i=0;i<arr.length;i++){if(arr[i].att===true){p.push(arr[i].id);}else if(arr[i].att===false){a.push(arr[i].id);}}setArrayP(p);setArrayA(a);today=yyyy+'-'+mm+'-'+dd;var obj={arrayP:arrayP,arrayA:arrayA,subject:subject,date:today};if(obj.arrayP.length>0){AuthService.markAttendance(obj).then(function(res){console.log(res);}).catch(function(e){console.log(e);});}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Admin-Container \".concat(val?\"activate\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Batch-Details\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Year-Dropdown\",children:/*#__PURE__*/_jsxs(\"select\",{id:\"year-drop\",onChange:handleYearDropdown,children:[/*#__PURE__*/_jsx(\"option\",{selected:\"selected\",hidden:true,children:\"Select Year\"}),years.map(function(y){return/*#__PURE__*/_jsx(\"option\",{name:y.id,value:y.id,children:y.yr},y.id);})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"Batch-Dropdown\",children:/*#__PURE__*/_jsxs(\"select\",{id:\"batch-drop\",disabled:flag,onChange:handleBatchDropdown,children:[/*#__PURE__*/_jsx(\"option\",{selected:\"selected\",hidden:true,children:\"Select Batch\"}),batches.map(function(b){return/*#__PURE__*/_jsx(\"option\",{name:b._id,value:b._id,children:b._id},b._id);})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"Apply-Button\",onClick:handleApply,children:/*#__PURE__*/_jsx(\"div\",{className:\"Apply-text\",children:/*#__PURE__*/_jsx(\"h4\",{children:\"Apply\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Student-Info-Table\",children:/*#__PURE__*/_jsx(TableContainer,{component:Paper,style:{width:val?\"81vw\":\"91vw\",position:\"relative\",top:\"2%\",height:\"65vh\"},children:/*#__PURE__*/_jsxs(Table,{style:{height:\"max-content\"},stickyHeader:true,children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",width:\"20%\",fontFamily:\"'Inter', sans-serif\"},align:\"center\",children:\"Roll Number\"}),/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",fontFamily:\"'Inter', sans-serif\"},align:\"center\",children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",fontFamily:\"'Inter', sans-serif\"},align:\"center\",children:\"Attendance \"})]})}),/*#__PURE__*/_jsx(TableBody,{children:tableData.map(function(data,id){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",fontFamily:\"'Inter', sans-serif\"},align:\"center\",children:data.roll}),/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",fontFamily:\"'Inter', sans-serif\"},align:\"center\",children:data.name}),/*#__PURE__*/_jsx(TableCell,{style:{border:\"0px solid transparent\",fontFamily:\"'Inter', sans-serif\",display:\"flex\",justifyContent:\"center\"},align:\"center\",children:arr.length>0&&arr[id].att?/*#__PURE__*/_jsx(\"div\",{className:\"Att-box\",style:{width:\"50px\",height:\"50px\",backgroundColor:\"lightgreen\",border:\"0.5px solid black\",color:\"black\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",fontSize:\"18px\",borderRadius:\"50%\",cursor:\"pointer\"},onClick:function onClick(){return handleClick(id);},children:\"P\"}):/*#__PURE__*/_jsx(\"div\",{className:\"Att-box\",style:{width:\"50px\",height:\"50px\",backgroundColor:\"#f15151\",border:\"0.5px solid black\",color:\"black\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",fontSize:\"18px\",borderRadius:\"50%\",cursor:\"pointer\"},onClick:function onClick(){return handleClick(id);},children:\"A\"})})]})});})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"Upload-Btn-att\",onClick:handleAtt,children:/*#__PURE__*/_jsx(\"h5\",{children:\"Upload\"})})]})});};export default MarkAttendance;","map":{"version":3,"sources":["E:/College-ERP/src/Pages/Dashboard/Faculty/Attendance/MarkAttendance.js"],"names":["React","useEffect","useState","Paper","TableContainer","TableBody","Table","TableHead","TableCell","TableRow","useDispatch","useSelector","AuthService","MarkAttendance","years","id","yr","state","toggle","val","flag","setFlag","flag1","setFlag1","batch","setBatch","year","setYear","batches","setBatches","tableData","setTableData","subject","setSubject","arr","setArr","arrayP","setArrayP","arrayA","setArrayA","idf","localStorage","getItem","loadBatch","getEachFaculty","then","res","console","log","data","catch","e","getBatch","a","handleClick","att","length","handleYearDropdown","target","value","handleBatchDropdown","preventDefault","handleApply","getStudents","students","map","_id","today","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","handleAtt","p","i","push","obj","date","markAttendance","y","b","width","position","top","height","border","fontFamily","roll","name","display","justifyContent","backgroundColor","color","alignItems","fontSize","borderRadius","cursor"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport './Attendance.css'\r\nimport { Paper, TableContainer, TableBody, Table, TableHead, TableCell, TableRow } from \"@material-ui/core\"\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport AuthService from '../../../../ApiServices/AuthService'\r\nconst MarkAttendance = () => {\r\n  const years = [{ id: \"1\", yr: \"First\" }, { id: \"2\", yr: \"Second\" }, { id: \"3\", yr: \"Third\" }, { id: \"4\", yr: \"Fourth\" }];\r\n  const { val } = useSelector((state) => state.toggle);\r\n  const [flag, setFlag] = useState(true);\r\n  const [flag1, setFlag1] = useState(false);\r\n  const [batch, setBatch] = useState(null);\r\n  const [year, setYear] = useState(null);\r\n  const [batches, setBatches] = useState([]);\r\n  const [tableData, setTableData] = useState([]);\r\n  const [subject, setSubject] = useState(null);\r\n  const [arr, setArr] = useState([]);\r\n  const [arrayP, setArrayP] = useState([]);\r\n  const [arrayA, setArrayA] = useState([]);\r\n\r\n  const idf = localStorage.getItem(\"userid\");\r\n\r\n  useEffect(() => {\r\n    loadBatch();\r\n\r\n  }, [year]);\r\n\r\n  useEffect(() => {\r\n    AuthService.getEachFaculty(idf)\r\n      .then((res) => {\r\n        console.log(res);\r\n        setSubject(res.data.subject);\r\n      }).catch((e) => {\r\n        console.log(e);\r\n      })\r\n  }, []);\r\n\r\n  const loadBatch = async () => {\r\n    try {\r\n      const res = await AuthService.getBatch(year);\r\n      setBatches(res.data);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n\r\n  }\r\n  let a;\r\n  const handleClick = (id) => {\r\n    a = [...arr];\r\n    a[id].att = !a[id].att;\r\n    setArr(a);\r\n  }\r\n  useEffect(() => {\r\n    if (arr.length > 0) {\r\n      console.log(arr);\r\n    }\r\n  }, [arr])\r\n\r\n  const handleYearDropdown = (e) => {\r\n    setYear(e.target.value);\r\n    console.log(e.target.value);\r\n    setFlag(false);\r\n  }\r\n  const handleBatchDropdown = (e) => {\r\n    e.preventDefault();\r\n    setBatch(e.target.value);\r\n    setFlag1(true);\r\n  }\r\n  const handleApply = (e) => {\r\n    e.preventDefault();\r\n    if (year && batch) {\r\n\r\n\r\n      AuthService.getStudents(batch, year)\r\n        .then((res) => {\r\n          console.log(res);\r\n          setTableData(res.data.students);\r\n          setArr(res.data.students.map(data => (\r\n            {\r\n              id: data._id,\r\n              att: true,\r\n            }\r\n          )))\r\n        }).catch((e) => {\r\n          console.log(e);\r\n        })\r\n    } else {\r\n      // show error\r\n    }\r\n  }\r\n  var today = new Date();\r\n  var dd = String(today.getDate()).padStart(2, '0');\r\n  var mm = String(today.getMonth() + 1).padStart(2, '0');\r\n  var yyyy = today.getFullYear();\r\n  const handleAtt = () => {\r\n    const p = [];\r\n    const a = [];\r\n    for (let i = 0; i < arr.length; i++) {\r\n      if (arr[i].att === true) {\r\n        p.push(arr[i].id);\r\n      } else if (arr[i].att === false) {\r\n        a.push(arr[i].id);\r\n      }\r\n    }\r\n    setArrayP(p);\r\n    setArrayA(a);\r\n    today = yyyy + '-' + mm + '-' + dd;\r\n    const obj = {\r\n      arrayP: arrayP,\r\n      arrayA: arrayA,\r\n      subject: subject,\r\n      date: today\r\n    }\r\n    if (obj.arrayP.length > 0) {\r\n      AuthService.markAttendance(obj)\r\n        .then((res) => {\r\n          console.log(res);\r\n        }).catch((e) => {\r\n          console.log(e);\r\n        })\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n  return (<>\r\n    <div className={`Admin-Container ${val ? \"activate\" : \"\"}`} >\r\n      <div className='Batch-Details'>\r\n        <div className='Year-Dropdown'>\r\n          <select id=\"year-drop\" onChange={handleYearDropdown}>\r\n            <option selected=\"selected\" hidden>Select Year</option>\r\n            {\r\n              years.map((y) => (\r\n                <option key={y.id} name={y.id} value={y.id}>{y.yr}</option>\r\n              ))\r\n            }\r\n          </select>\r\n        </div>\r\n        <div className='Batch-Dropdown'>\r\n          <select id=\"batch-drop\" disabled={flag} onChange={handleBatchDropdown}>\r\n            <option selected=\"selected\" hidden>Select Batch</option>\r\n            {\r\n              batches.map((b) => (\r\n                <option key={b._id} name={b._id} value={b._id}>{b._id}</option>\r\n              ))\r\n            }\r\n          </select>\r\n        </div>\r\n        <div className='Apply-Button' onClick={handleApply}>\r\n          <div className='Apply-text'>\r\n            <h4>Apply</h4>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className='Student-Info-Table'>\r\n\r\n        <TableContainer component={Paper} style={{\r\n          width: val ? \"81vw\" : \"91vw\",\r\n          position: \"relative\",\r\n          top: \"2%\",\r\n          height: \"65vh\"\r\n\r\n        }} >\r\n          <Table style={{ height: \"max-content\" }} stickyHeader>\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell style={{ border: \"0px solid transparent\", width: \"20%\", fontFamily: \"'Inter', sans-serif\" }} align='center'>Roll Number</TableCell>\r\n                <TableCell style={{ border: \"0px solid transparent\", fontFamily: \"'Inter', sans-serif\" }} align='center'>Name</TableCell>\r\n                <TableCell style={{ border: \"0px solid transparent\", fontFamily: \"'Inter', sans-serif\" }} align='center'>Attendance </TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n\r\n              {\r\n                tableData.map((data, id) => (<>\r\n                  <TableRow>\r\n                    <TableCell style={{ border: \"0px solid transparent\", fontFamily: \"'Inter', sans-serif\" }} align='center'>{data.roll}</TableCell>\r\n                    <TableCell style={{ border: \"0px solid transparent\", fontFamily: \"'Inter', sans-serif\" }} align='center'>{data.name}</TableCell>\r\n                    <TableCell style={{ border: \"0px solid transparent\", fontFamily: \"'Inter', sans-serif\", display: \"flex\", justifyContent: \"center\" }} align='center'>\r\n                      {\r\n\r\n                        arr.length > 0 && arr[id].att ? <div className='Att-box' style={{ width: \"50px\", height: \"50px\", backgroundColor: \"lightgreen\", border: \"0.5px solid black\", color: \"black\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\", fontSize: \"18px\", borderRadius: \"50%\", cursor: \"pointer\" }} onClick={() => handleClick(id)} >\r\n                          P\r\n                        </div> :\r\n                          <div className='Att-box' style={{ width: \"50px\", height: \"50px\", backgroundColor: \"#f15151\", border: \"0.5px solid black\", color: \"black\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\", fontSize: \"18px\", borderRadius: \"50%\", cursor: \"pointer\" }} onClick={() => handleClick(id)}  >\r\n                            A\r\n                          </div>}\r\n                    </TableCell>\r\n                  </TableRow>\r\n                </>))\r\n              }\r\n            </TableBody>\r\n          </Table>\r\n        </TableContainer>\r\n\r\n      </div>\r\n      <div className='Upload-Btn-att' onClick={handleAtt}>\r\n        <h5>Upload</h5>\r\n      </div>\r\n    </div>\r\n  </>);\r\n};\r\n\r\nexport default MarkAttendance;"]},"metadata":{},"sourceType":"module"}