{"ast":null,"code":"\"use strict\";\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar object_get_listener_1 = require(\"./utils/object-get-listener\");\n\nvar copyObject = function copyObject(obj) {\n  return Object.assign(Object.create(null), obj);\n};\n\nexports.INVALID_NEW_GLOBAL_STATE = new Error('ReactN global state must be a function, null, object, or Promise.');\n\nvar GlobalStateManager = function () {\n  function GlobalStateManager(initialState, initialReducers) {\n    if (initialState === void 0) {\n      initialState = Object.create(null);\n    }\n\n    if (initialReducers === void 0) {\n      initialReducers = Object.create(null);\n    }\n\n    this._callbacks = new Set();\n    this._dispatchers = Object.create(null);\n    this._middlewares = new Set();\n    this._propertyListeners = new Map();\n    this._queue = new Map();\n    this._initialReducers = copyObject(initialReducers);\n    this._initialState = copyObject(initialState);\n    this._state = copyObject(initialState);\n    this.addReducers(initialReducers);\n  }\n\n  GlobalStateManager.prototype.addCallback = function (callback) {\n    var _this = this;\n\n    this._callbacks.add(callback);\n\n    return function () {\n      return _this.removeCallback(callback);\n    };\n  };\n\n  GlobalStateManager.prototype.addMiddleware = function (createMiddleware) {\n    var _this = this;\n\n    var middleware = createMiddleware(this.state, this.dispatchers);\n\n    this._middlewares.add(middleware);\n\n    return function () {\n      return _this.removeMiddleware(middleware);\n    };\n  };\n\n  GlobalStateManager.prototype.addPropertyListener = function (property, propertyListener) {\n    if (this.propertyListeners.has(property)) {\n      this.propertyListeners.get(property).add(propertyListener);\n    } else {\n      this.propertyListeners.set(property, new Set([propertyListener]));\n    }\n  };\n\n  GlobalStateManager.prototype.addReducer = function (name, reducer) {\n    var _this = this;\n\n    this._dispatchers[name] = this.createDispatcher(reducer, name);\n    return function () {\n      return _this.removeDispatcher(name);\n    };\n  };\n\n  GlobalStateManager.prototype.addReducers = function (reducers) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(Object.entries(reducers)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var _d = __read(_c.value, 2),\n            name_1 = _d[0],\n            reducer = _d[1];\n\n        this.addReducer(name_1, reducer);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  GlobalStateManager.prototype.clearQueue = function () {\n    return this.queue.clear();\n  };\n\n  GlobalStateManager.prototype.createDispatcher = function (reducer, name) {\n    var _this = this;\n\n    if (name === void 0) {\n      name = reducer.name;\n    }\n\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return _this.set(reducer.apply(void 0, __spread([_this.state, _this.dispatcherMap], args)), name, args).then(function () {\n        return _this.state;\n      });\n    };\n  };\n\n  Object.defineProperty(GlobalStateManager.prototype, \"dispatcherMap\", {\n    get: function get() {\n      var _this = this;\n\n      var dispatch = function dispatch(newGlobalState) {\n        return _this.set(newGlobalState).then(function () {\n          return _this.state;\n        });\n      };\n\n      return Object.assign(dispatch, this.dispatchers);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(GlobalStateManager.prototype, \"dispatchers\", {\n    get: function get() {\n      return copyObject(this._dispatchers);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  GlobalStateManager.prototype.enqueue = function (property, value) {\n    this._queue.set(property, value);\n  };\n\n  GlobalStateManager.prototype.flush = function (reducerName, reducerArgs) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var propertyListeners = new Set();\n    var stateChange = Object.create(null);\n    this.queue.forEach(function (value, key) {\n      stateChange[key] = value;\n    });\n\n    try {\n      for (var _e = __values(this.queue.entries()), _f = _e.next(); !_f.done; _f = _e.next()) {\n        var _g = __read(_f.value, 2),\n            property = _g[0],\n            value = _g[1];\n\n        this._state[property] = value;\n\n        if (this.propertyListeners.has(property)) {\n          try {\n            for (var _h = (e_3 = void 0, __values(this.propertyListeners.get(property))), _j = _h.next(); !_j.done; _j = _h.next()) {\n              var propertyListener = _j.value;\n              propertyListeners.add(propertyListener);\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    this.clearQueue();\n\n    try {\n      for (var propertyListeners_1 = __values(propertyListeners), propertyListeners_1_1 = propertyListeners_1.next(); !propertyListeners_1_1.done; propertyListeners_1_1 = propertyListeners_1.next()) {\n        var propertyListener = propertyListeners_1_1.value;\n        propertyListener();\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (propertyListeners_1_1 && !propertyListeners_1_1.done && (_c = propertyListeners_1.return)) _c.call(propertyListeners_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this._callbacks), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var callback = _l.value;\n        this.set(callback(this.state, this.dispatchers, stateChange, reducerName, reducerArgs));\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_d = _k.return)) _d.call(_k);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    return stateChange;\n  };\n\n  GlobalStateManager.prototype.getDispatcher = function (name) {\n    if (this.hasDispatcher(name)) {\n      return this._dispatchers[name];\n    }\n\n    throw new Error(\"Cannot return unknown ReactN reducer `\" + name + \"`.\");\n  };\n\n  GlobalStateManager.prototype.hasCallback = function (callback) {\n    return this._callbacks.has(callback);\n  };\n\n  GlobalStateManager.prototype.hasMiddleware = function (middleware) {\n    return this._middlewares.has(middleware);\n  };\n\n  GlobalStateManager.prototype.hasPropertyListener = function (pl) {\n    var e_6, _a, e_7, _b;\n\n    try {\n      for (var _c = __values(this.propertyListeners.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\n        var propertyListeners = _d.value;\n\n        try {\n          for (var propertyListeners_2 = (e_7 = void 0, __values(propertyListeners)), propertyListeners_2_1 = propertyListeners_2.next(); !propertyListeners_2_1.done; propertyListeners_2_1 = propertyListeners_2.next()) {\n            var propertyListener = propertyListeners_2_1.value;\n\n            if (propertyListener === pl) {\n              return true;\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (propertyListeners_2_1 && !propertyListeners_2_1.done && (_b = propertyListeners_2.return)) _b.call(propertyListeners_2);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    return false;\n  };\n\n  GlobalStateManager.prototype.hasDispatcher = function (name) {\n    return Object.prototype.hasOwnProperty.call(this._dispatchers, name);\n  };\n\n  Object.defineProperty(GlobalStateManager.prototype, \"queue\", {\n    get: function get() {\n      return this._queue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(GlobalStateManager.prototype, \"propertyListeners\", {\n    get: function get() {\n      return this._propertyListeners;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  GlobalStateManager.prototype.removeCallback = function (callback) {\n    return this._callbacks.delete(callback);\n  };\n\n  GlobalStateManager.prototype.removeDispatcher = function (name) {\n    if (this.hasDispatcher(name)) {\n      delete this._dispatchers[name];\n      return true;\n    }\n\n    return false;\n  };\n\n  GlobalStateManager.prototype.removeMiddleware = function (middleware) {\n    return this._middlewares.delete(middleware);\n  };\n\n  GlobalStateManager.prototype.removePropertyListener = function (propertyListener) {\n    var e_8, _a;\n\n    var removed = false;\n\n    try {\n      for (var _b = __values(this.propertyListeners.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var propertyListeners = _c.value;\n\n        if (propertyListeners.delete(propertyListener)) {\n          removed = true;\n        }\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    return removed;\n  };\n\n  GlobalStateManager.prototype.reset = function () {\n    this._callbacks.clear();\n\n    this._dispatchers = Object.create(null);\n\n    this._middlewares.clear();\n\n    this._propertyListeners.clear();\n\n    this._queue.clear();\n\n    this.addReducers(this._initialReducers);\n    this._state = copyObject(this._initialState);\n  };\n\n  GlobalStateManager.prototype.set = function (newGlobalState, reducerName, reducerArgs) {\n    if (newGlobalState === null || typeof newGlobalState === 'undefined') {\n      return Promise.resolve(Object.create(null));\n    }\n\n    if (newGlobalState instanceof Promise) {\n      return this.setPromise(newGlobalState, reducerName, reducerArgs);\n    }\n\n    if (typeof newGlobalState === 'function') {\n      return this.setFunction(newGlobalState, reducerName, reducerArgs);\n    }\n\n    if (typeof newGlobalState === 'object') {\n      return this.setObject(newGlobalState, reducerName, reducerArgs);\n    }\n\n    throw exports.INVALID_NEW_GLOBAL_STATE;\n  };\n\n  GlobalStateManager.prototype.setFunction = function (f, reducerName, reducerArgs) {\n    return this.set(f(this.state, reducerName, reducerArgs), reducerName, reducerArgs);\n  };\n\n  GlobalStateManager.prototype.setObject = function (obj, reducerName, reducerArgs) {\n    var e_9, _a;\n\n    var properties = Object.keys(obj);\n\n    try {\n      for (var properties_1 = __values(properties), properties_1_1 = properties_1.next(); !properties_1_1.done; properties_1_1 = properties_1.next()) {\n        var property = properties_1_1.value;\n        var value = obj[property];\n        this.enqueue(property, value);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (properties_1_1 && !properties_1_1.done && (_a = properties_1.return)) _a.call(properties_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    var stateChange = this.flush(reducerName, reducerArgs);\n    return Promise.resolve(stateChange);\n  };\n\n  GlobalStateManager.prototype.setPromise = function (promise, reducerName, reducerArgs) {\n    var _this = this;\n\n    return promise.then(function (result) {\n      return _this.set(result, reducerName, reducerArgs);\n    });\n  };\n\n  GlobalStateManager.prototype.spyState = function (propertyListener) {\n    var _this = this;\n\n    return object_get_listener_1.default(this._state, function (property) {\n      _this.addPropertyListener(property, propertyListener);\n    });\n  };\n\n  Object.defineProperty(GlobalStateManager.prototype, \"state\", {\n    get: function get() {\n      return copyObject(this._state);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return GlobalStateManager;\n}();\n\nexports.default = GlobalStateManager;\n;","map":{"version":3,"sources":["E:/College-ERP/node_modules/reactn/build/global-state-manager.js"],"names":["__values","o","s","Symbol","iterator","m","i","call","length","next","value","done","TypeError","__read","n","r","ar","e","push","error","__spread","arguments","concat","Object","defineProperty","exports","object_get_listener_1","require","copyObject","obj","assign","create","INVALID_NEW_GLOBAL_STATE","Error","GlobalStateManager","initialState","initialReducers","_callbacks","Set","_dispatchers","_middlewares","_propertyListeners","Map","_queue","_initialReducers","_initialState","_state","addReducers","prototype","addCallback","callback","_this","add","removeCallback","addMiddleware","createMiddleware","middleware","state","dispatchers","removeMiddleware","addPropertyListener","property","propertyListener","propertyListeners","has","get","set","addReducer","name","reducer","createDispatcher","removeDispatcher","reducers","e_1","_a","_b","entries","_c","_d","name_1","e_1_1","return","clearQueue","queue","clear","args","_i","apply","dispatcherMap","then","dispatch","newGlobalState","enumerable","configurable","enqueue","flush","reducerName","reducerArgs","e_2","e_3","e_4","e_5","stateChange","forEach","key","_e","_f","_g","_h","_j","e_3_1","e_2_1","propertyListeners_1","propertyListeners_1_1","e_4_1","_k","_l","e_5_1","getDispatcher","hasDispatcher","hasCallback","hasMiddleware","hasPropertyListener","pl","e_6","e_7","values","propertyListeners_2","propertyListeners_2_1","e_7_1","e_6_1","hasOwnProperty","delete","removePropertyListener","e_8","removed","e_8_1","reset","Promise","resolve","setPromise","setFunction","setObject","f","e_9","properties","keys","properties_1","properties_1_1","e_9_1","promise","result","spyState","default"],"mappings":"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","sourcesContent":["\"use strict\";\r\nvar __values = (this && this.__values) || function(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n};\r\nvar __read = (this && this.__read) || function (o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n};\r\nvar __spread = (this && this.__spread) || function () {\r\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar object_get_listener_1 = require(\"./utils/object-get-listener\");\r\nvar copyObject = function (obj) {\r\n    return Object.assign(Object.create(null), obj);\r\n};\r\nexports.INVALID_NEW_GLOBAL_STATE = new Error('ReactN global state must be a function, null, object, or Promise.');\r\nvar GlobalStateManager = (function () {\r\n    function GlobalStateManager(initialState, initialReducers) {\r\n        if (initialState === void 0) { initialState = Object.create(null); }\r\n        if (initialReducers === void 0) { initialReducers = Object.create(null); }\r\n        this._callbacks = new Set();\r\n        this._dispatchers = Object.create(null);\r\n        this._middlewares = new Set();\r\n        this._propertyListeners = new Map();\r\n        this._queue = new Map();\r\n        this._initialReducers = copyObject(initialReducers);\r\n        this._initialState = copyObject(initialState);\r\n        this._state = copyObject(initialState);\r\n        this.addReducers(initialReducers);\r\n    }\r\n    GlobalStateManager.prototype.addCallback = function (callback) {\r\n        var _this = this;\r\n        this._callbacks.add(callback);\r\n        return function () {\r\n            return _this.removeCallback(callback);\r\n        };\r\n    };\r\n    GlobalStateManager.prototype.addMiddleware = function (createMiddleware) {\r\n        var _this = this;\r\n        var middleware = createMiddleware(this.state, this.dispatchers);\r\n        this._middlewares.add(middleware);\r\n        return function () {\r\n            return _this.removeMiddleware(middleware);\r\n        };\r\n    };\r\n    GlobalStateManager.prototype.addPropertyListener = function (property, propertyListener) {\r\n        if (this.propertyListeners.has(property)) {\r\n            this.propertyListeners.get(property).add(propertyListener);\r\n        }\r\n        else {\r\n            this.propertyListeners.set(property, new Set([propertyListener]));\r\n        }\r\n    };\r\n    GlobalStateManager.prototype.addReducer = function (name, reducer) {\r\n        var _this = this;\r\n        this._dispatchers[name] = this.createDispatcher(reducer, name);\r\n        return function () {\r\n            return _this.removeDispatcher(name);\r\n        };\r\n    };\r\n    GlobalStateManager.prototype.addReducers = function (reducers) {\r\n        var e_1, _a;\r\n        try {\r\n            for (var _b = __values(Object.entries(reducers)), _c = _b.next(); !_c.done; _c = _b.next()) {\r\n                var _d = __read(_c.value, 2), name_1 = _d[0], reducer = _d[1];\r\n                this.addReducer(name_1, reducer);\r\n            }\r\n        }\r\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n        finally {\r\n            try {\r\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\r\n            }\r\n            finally { if (e_1) throw e_1.error; }\r\n        }\r\n    };\r\n    GlobalStateManager.prototype.clearQueue = function () {\r\n        return this.queue.clear();\r\n    };\r\n    GlobalStateManager.prototype.createDispatcher = function (reducer, name) {\r\n        var _this = this;\r\n        if (name === void 0) { name = reducer.name; }\r\n        return function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return _this.set(reducer.apply(void 0, __spread([_this.state, _this.dispatcherMap], args)), name, args)\r\n                .then(function () { return _this.state; });\r\n        };\r\n    };\r\n    Object.defineProperty(GlobalStateManager.prototype, \"dispatcherMap\", {\r\n        get: function () {\r\n            var _this = this;\r\n            var dispatch = function (newGlobalState) {\r\n                return _this.set(newGlobalState).then(function () { return _this.state; });\r\n            };\r\n            return Object.assign(dispatch, this.dispatchers);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GlobalStateManager.prototype, \"dispatchers\", {\r\n        get: function () {\r\n            return copyObject(this._dispatchers);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GlobalStateManager.prototype.enqueue = function (property, value) {\r\n        this._queue.set(property, value);\r\n    };\r\n    GlobalStateManager.prototype.flush = function (reducerName, reducerArgs) {\r\n        var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\r\n        var propertyListeners = new Set();\r\n        var stateChange = Object.create(null);\r\n        this.queue.forEach(function (value, key) {\r\n            stateChange[key] = value;\r\n        });\r\n        try {\r\n            for (var _e = __values(this.queue.entries()), _f = _e.next(); !_f.done; _f = _e.next()) {\r\n                var _g = __read(_f.value, 2), property = _g[0], value = _g[1];\r\n                this._state[property] = value;\r\n                if (this.propertyListeners.has(property)) {\r\n                    try {\r\n                        for (var _h = (e_3 = void 0, __values(this.propertyListeners.get(property))), _j = _h.next(); !_j.done; _j = _h.next()) {\r\n                            var propertyListener = _j.value;\r\n                            propertyListeners.add(propertyListener);\r\n                        }\r\n                    }\r\n                    catch (e_3_1) { e_3 = { error: e_3_1 }; }\r\n                    finally {\r\n                        try {\r\n                            if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\r\n                        }\r\n                        finally { if (e_3) throw e_3.error; }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n        finally {\r\n            try {\r\n                if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\r\n            }\r\n            finally { if (e_2) throw e_2.error; }\r\n        }\r\n        this.clearQueue();\r\n        try {\r\n            for (var propertyListeners_1 = __values(propertyListeners), propertyListeners_1_1 = propertyListeners_1.next(); !propertyListeners_1_1.done; propertyListeners_1_1 = propertyListeners_1.next()) {\r\n                var propertyListener = propertyListeners_1_1.value;\r\n                propertyListener();\r\n            }\r\n        }\r\n        catch (e_4_1) { e_4 = { error: e_4_1 }; }\r\n        finally {\r\n            try {\r\n                if (propertyListeners_1_1 && !propertyListeners_1_1.done && (_c = propertyListeners_1.return)) _c.call(propertyListeners_1);\r\n            }\r\n            finally { if (e_4) throw e_4.error; }\r\n        }\r\n        try {\r\n            for (var _k = __values(this._callbacks), _l = _k.next(); !_l.done; _l = _k.next()) {\r\n                var callback = _l.value;\r\n                this.set(callback(this.state, this.dispatchers, stateChange, reducerName, reducerArgs));\r\n            }\r\n        }\r\n        catch (e_5_1) { e_5 = { error: e_5_1 }; }\r\n        finally {\r\n            try {\r\n                if (_l && !_l.done && (_d = _k.return)) _d.call(_k);\r\n            }\r\n            finally { if (e_5) throw e_5.error; }\r\n        }\r\n        return stateChange;\r\n    };\r\n    GlobalStateManager.prototype.getDispatcher = function (name) {\r\n        if (this.hasDispatcher(name)) {\r\n            return this._dispatchers[name];\r\n        }\r\n        throw new Error(\"Cannot return unknown ReactN reducer `\" + name + \"`.\");\r\n    };\r\n    GlobalStateManager.prototype.hasCallback = function (callback) {\r\n        return this._callbacks.has(callback);\r\n    };\r\n    GlobalStateManager.prototype.hasMiddleware = function (middleware) {\r\n        return this._middlewares.has(middleware);\r\n    };\r\n    GlobalStateManager.prototype.hasPropertyListener = function (pl) {\r\n        var e_6, _a, e_7, _b;\r\n        try {\r\n            for (var _c = __values(this.propertyListeners.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                var propertyListeners = _d.value;\r\n                try {\r\n                    for (var propertyListeners_2 = (e_7 = void 0, __values(propertyListeners)), propertyListeners_2_1 = propertyListeners_2.next(); !propertyListeners_2_1.done; propertyListeners_2_1 = propertyListeners_2.next()) {\r\n                        var propertyListener = propertyListeners_2_1.value;\r\n                        if (propertyListener === pl) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n                catch (e_7_1) { e_7 = { error: e_7_1 }; }\r\n                finally {\r\n                    try {\r\n                        if (propertyListeners_2_1 && !propertyListeners_2_1.done && (_b = propertyListeners_2.return)) _b.call(propertyListeners_2);\r\n                    }\r\n                    finally { if (e_7) throw e_7.error; }\r\n                }\r\n            }\r\n        }\r\n        catch (e_6_1) { e_6 = { error: e_6_1 }; }\r\n        finally {\r\n            try {\r\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\r\n            }\r\n            finally { if (e_6) throw e_6.error; }\r\n        }\r\n        return false;\r\n    };\r\n    GlobalStateManager.prototype.hasDispatcher = function (name) {\r\n        return Object.prototype.hasOwnProperty.call(this._dispatchers, name);\r\n    };\r\n    Object.defineProperty(GlobalStateManager.prototype, \"queue\", {\r\n        get: function () {\r\n            return this._queue;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GlobalStateManager.prototype, \"propertyListeners\", {\r\n        get: function () {\r\n            return this._propertyListeners;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    GlobalStateManager.prototype.removeCallback = function (callback) {\r\n        return this._callbacks.delete(callback);\r\n    };\r\n    GlobalStateManager.prototype.removeDispatcher = function (name) {\r\n        if (this.hasDispatcher(name)) {\r\n            delete this._dispatchers[name];\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    GlobalStateManager.prototype.removeMiddleware = function (middleware) {\r\n        return this._middlewares.delete(middleware);\r\n    };\r\n    GlobalStateManager.prototype.removePropertyListener = function (propertyListener) {\r\n        var e_8, _a;\r\n        var removed = false;\r\n        try {\r\n            for (var _b = __values(this.propertyListeners.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\r\n                var propertyListeners = _c.value;\r\n                if (propertyListeners.delete(propertyListener)) {\r\n                    removed = true;\r\n                }\r\n            }\r\n        }\r\n        catch (e_8_1) { e_8 = { error: e_8_1 }; }\r\n        finally {\r\n            try {\r\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\r\n            }\r\n            finally { if (e_8) throw e_8.error; }\r\n        }\r\n        return removed;\r\n    };\r\n    GlobalStateManager.prototype.reset = function () {\r\n        this._callbacks.clear();\r\n        this._dispatchers = Object.create(null);\r\n        this._middlewares.clear();\r\n        this._propertyListeners.clear();\r\n        this._queue.clear();\r\n        this.addReducers(this._initialReducers);\r\n        this._state = copyObject(this._initialState);\r\n    };\r\n    GlobalStateManager.prototype.set = function (newGlobalState, reducerName, reducerArgs) {\r\n        if (newGlobalState === null ||\r\n            typeof newGlobalState === 'undefined') {\r\n            return Promise.resolve(Object.create(null));\r\n        }\r\n        if (newGlobalState instanceof Promise) {\r\n            return this.setPromise(newGlobalState, reducerName, reducerArgs);\r\n        }\r\n        if (typeof newGlobalState === 'function') {\r\n            return this.setFunction(newGlobalState, reducerName, reducerArgs);\r\n        }\r\n        if (typeof newGlobalState === 'object') {\r\n            return this.setObject(newGlobalState, reducerName, reducerArgs);\r\n        }\r\n        throw exports.INVALID_NEW_GLOBAL_STATE;\r\n    };\r\n    GlobalStateManager.prototype.setFunction = function (f, reducerName, reducerArgs) {\r\n        return this.set(f(this.state, reducerName, reducerArgs), reducerName, reducerArgs);\r\n    };\r\n    GlobalStateManager.prototype.setObject = function (obj, reducerName, reducerArgs) {\r\n        var e_9, _a;\r\n        var properties = Object.keys(obj);\r\n        try {\r\n            for (var properties_1 = __values(properties), properties_1_1 = properties_1.next(); !properties_1_1.done; properties_1_1 = properties_1.next()) {\r\n                var property = properties_1_1.value;\r\n                var value = obj[property];\r\n                this.enqueue(property, value);\r\n            }\r\n        }\r\n        catch (e_9_1) { e_9 = { error: e_9_1 }; }\r\n        finally {\r\n            try {\r\n                if (properties_1_1 && !properties_1_1.done && (_a = properties_1.return)) _a.call(properties_1);\r\n            }\r\n            finally { if (e_9) throw e_9.error; }\r\n        }\r\n        var stateChange = this.flush(reducerName, reducerArgs);\r\n        return Promise.resolve(stateChange);\r\n    };\r\n    GlobalStateManager.prototype.setPromise = function (promise, reducerName, reducerArgs) {\r\n        var _this = this;\r\n        return promise\r\n            .then(function (result) {\r\n            return _this.set(result, reducerName, reducerArgs);\r\n        });\r\n    };\r\n    GlobalStateManager.prototype.spyState = function (propertyListener) {\r\n        var _this = this;\r\n        return object_get_listener_1.default(this._state, function (property) {\r\n            _this.addPropertyListener(property, propertyListener);\r\n        });\r\n    };\r\n    Object.defineProperty(GlobalStateManager.prototype, \"state\", {\r\n        get: function () {\r\n            return copyObject(this._state);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return GlobalStateManager;\r\n}());\r\nexports.default = GlobalStateManager;\r\n;\r\n"]},"metadata":{},"sourceType":"script"}